{"version":3,"sources":["store/utility.js","store/reducers/auth.js","store/actions/actionTypes.js","store/reducers/nav.js","store/reducers/message.js","hoc/hoc.js","settings.js","websocket.js","containers/Chat.js","routes.js","store/actions/auth.js","store/actions/message.js","components/Contact.js","containers/Sidepanel.js","store/actions/nav.js","containers/Profile.js","containers/Form.js","containers/Popup.js","App.js","index.js"],"names":["updateObject","oldObject","updatedProperties","Object","objectSpread","initialState","token","username","error","loading","console","log","reducer","state","arguments","length","undefined","action","type","authStart","authSuccess","authFail","authLogout","showAddChatPopup","openAddChatPopup","closeAddChatPopup","messages","chats","toConsumableArray","concat","message","addMessage","reverse","setMessages","setChats","Hoc","props","children","HOST_URL","SOCKET_URL","WebSocketService","classCallCheck","this","callbacks","socketRef","instance","chatUrl","_this","path","WebSocket","onopen","onmessage","e","socketNewMessage","data","onerror","onclose","connect","close","parsedData","JSON","parse","command","keys","chatId","sendMessage","from","content","messagesCallback","newMessageCallback","send","stringify","err","readyState","WebSocketInstance","getInstance","Chat","possibleConstructorReturn","getPrototypeOf","call","messageChangeHandler","event","setState","target","value","sendMessageHandler","preventDefault","messageObject","match","params","chatID","newChatMessage","renderTimestamp","timestamp","timeDiff","Math","round","Date","getTime","renderMessages","currentUser","map","i","arr","react_default","a","createElement","key","id","style","marginBottom","className","author","src","alt","scrollToBottom","messagesEnd","scrollIntoView","behavior","initialiseChat","_this2","waitForSocketConnection","fetchMessages","callback","component","setTimeout","newProps","_this3","disconnect","_this4","hoc","float","clear","ref","el","onSubmit","onChange","required","placeholder","aria-hidden","React","Component","auth","BaseRouter","Route","exact","logout","localStorage","removeItem","checkAuthTimeout","expirationTime","dispatch","getUserChats","axios","defaults","xsrfHeaderName","xsrfCookieName","headers","Content-Type","Authorization","get","then","res","Contact","NavLink","to","chatURL","color","status","picURL","name","antIcon","icon","fontSize","spin","Sidepanel","loginForm","changeForm","authenticate","login","password","signup","email","password2","waitForAuthDetails","addChat","activeChats","c","partner","participants","filter","components_Contact","indicator","isAuthenticated","onClick","method","htmlFor","userName","post","expirationDate","setItem","catch","actions","password1","messageActions","Profile","Redirect","FormItem","Form","Item","HorizontalAddChatForm","usernames","handleChange","handleSubmit","form","validateFields","values","combined","history","push","fieldsError","_this$props$form","getFieldDecorator","getFieldsError","getFieldError","userNameError","isFieldTouched","es_form","layout","validateStatus","help","rules","es_select","mode","width","es_button","htmlType","disabled","some","field","AddChatForm","create","withRouter","AddChatModal","modal","centered","footer","visible","isVisible","onCancel","App","addCallbacks","bind","assertThisInitialized","onTryAutoSignup","authenticated","BrowserRouter","containers_Sidepanel","Popup","containers_Profile","routes","nav","getItem","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","rootReducer","combineReducers","authReducer","navReducer","messageReducer","createStore","applyMiddleware","thunk","configureStore","app","es","src_App","ReactDOM","render","document","getElementById"],"mappings":"2OAAaA,EAAe,SAACC,EAAWC,GACtC,OAAOC,OAAAC,EAAA,EAAAD,CAAA,GACFF,EACAC,ICADG,EAAe,CACnBC,MAAO,KACPC,SAAU,KACVC,MAAO,KACPC,SAAS,GASXC,QAAQC,IAAI,QACZ,IAsCeC,EAfC,WAAkC,IAAjCC,EAAiCC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAzBT,EAAcY,EAAWH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAChD,OAAQC,EAAOC,MACb,IC1CsB,aD2CpB,OAjCY,SAACL,EAAOI,GACxB,OAAOjB,EAAaa,EAAO,CACzBL,MAAO,KACPC,SAAS,IA8BAU,CAAUN,GACnB,IC3CwB,eD4CtB,OA5Bc,SAACA,EAAOI,GAC1B,OAAOjB,EAAaa,EAAO,CACzBP,MAAOW,EAAOX,MACdC,SAAUU,EAAOV,SACjBC,MAAO,KACPC,SAAS,IAuBAW,CAAYP,EAAOI,GAC5B,IC5CqB,YD6CnB,OArBW,SAACJ,EAAOI,GACvB,OAAOjB,EAAaa,EAAO,CACzBL,MAAOS,EAAOT,MACdC,SAAS,IAkBAY,CAASR,EAAOI,GACzB,IC7CuB,cD8CrB,OAhBa,SAACJ,EAAOI,GACzB,OAAOjB,EAAaa,EAAO,CACzBP,MAAO,KACPC,SAAU,OAaDe,CAAWT,GACpB,QACE,OAAOA,IEhDPR,EAAe,CACnBkB,kBAAkB,GAsBLX,EAXC,WAAkC,IAAjCC,EAAiCC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAzBT,EAAcY,EAAWH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAChD,OAAQC,EAAOC,MACb,IDb+B,sBCc7B,OAXmB,SAACL,EAAOI,GAC/B,OAAOjB,EAAaa,EAAO,CAAEU,kBAAkB,IAUpCC,CAAiBX,GAC1B,IDdgC,uBCe9B,OAToB,SAACA,EAAOI,GAChC,OAAOjB,EAAaa,EAAO,CAAEU,kBAAkB,IAQpCE,CAAkBZ,GAC3B,QACE,OAAOA,YCnBPR,EAAe,CACnBqB,SAAU,GACVC,MAAO,IAkCMf,EAbC,WAAkC,IAAjCC,EAAiCC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAzBT,EAAcY,EAAWH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAChD,OAAQC,EAAOC,MACb,IFtBuB,cEuBrB,OArBa,SAACL,EAAOI,GACzB,OAAOjB,EAAaa,EAAO,CACzBa,SAASvB,OAAAyB,EAAA,EAAAzB,CAAKU,EAAMa,UAAZG,OAAA,CAAsBZ,EAAOa,YAmB5BC,CAAWlB,EAAOI,GAC3B,IFvBwB,eEwBtB,OAjBc,SAACJ,EAAOI,GAC1B,OAAOjB,EAAaa,EAAO,CACzBa,SAAUT,EAAOS,SAASM,YAejBC,CAAYpB,EAAOI,GAC5B,IFxB6B,oBEyB3B,OAbW,SAACJ,EAAOI,GACvB,OAAOjB,EAAaa,EAAO,CACzBc,MAAOV,EAAOU,QAWLO,CAASrB,EAAOI,GACzB,QACE,OAAOJ,sECjCEsB,EAFH,SAAAC,GAAK,OAAIA,EAAMC,UCCvBC,EAAW,wCACXC,EAAa,sCAEfD,EAAW,wBACXC,EAAa,0BCHTC,aAWJ,SAAAA,IAAerC,OAAAsC,EAAA,EAAAtC,CAAAuC,KAAAF,GAAAE,KATfC,UAAY,GAUVD,KAAKE,UAAY,oEAJjB,OAHKJ,EAAiBK,WACpBL,EAAiBK,SAAW,IAAIL,GAE3BA,EAAiBK,0DAOlBC,GAAS,IAAAC,EAAAL,KACTM,EAAI,GAAAnB,OAAMU,EAAN,aAAAV,OAA4BiB,EAA5B,KACVJ,KAAKE,UAAY,IAAIK,UAAUD,GAC/BN,KAAKE,UAAUM,OAAS,WACtBxC,QAAQC,IAAI,mBAEd+B,KAAKE,UAAUO,UAAY,SAAAC,GACzBL,EAAKM,iBAAiBD,EAAEE,OAE1BZ,KAAKE,UAAUW,QAAU,SAAAH,GACvB1C,QAAQC,IAAIyC,EAAEtB,UAEhBY,KAAKE,UAAUY,QAAU,WACvB9C,QAAQC,IAAI,iCACZoC,EAAKU,gDAKPf,KAAKE,UAAUc,iDAGAJ,GACf,IAAMK,EAAaC,KAAKC,MAAMP,GACxBQ,EAAUH,EAAWG,QACgB,IAAvC3D,OAAO4D,KAAKrB,KAAKC,WAAW5B,SAGhB,aAAZ+C,GACFpB,KAAKC,UAAUmB,GAASH,EAAWjC,UAErB,gBAAZoC,GACFpB,KAAKC,UAAUmB,GAASH,EAAW7B,gDAIzBvB,EAAUyD,GACtBtB,KAAKuB,YAAY,CACfH,QAAS,iBACTvD,SAAUA,EACVyD,OAAQA,2CAIGlC,GACbY,KAAKuB,YAAY,CACfH,QAAS,cACTI,KAAMpC,EAAQoC,KACdpC,QAASA,EAAQqC,QACjBH,OAAQlC,EAAQkC,8CAIPI,EAAkBC,GAC7B3B,KAAKC,UAAL,SAA6ByB,EAC7B1B,KAAKC,UAAL,YAAgC0B,sCAGtBf,GACV,IACEZ,KAAKE,UAAU0B,KAAKV,KAAKW,UAALpE,OAAAC,EAAA,EAAAD,CAAA,GAAoBmD,KACxC,MAAOkB,GACP9D,QAAQC,IAAI6D,EAAI1C,0CAKlB,OAAOY,KAAKE,UAAU6B,oBAlFpBjC,EACGK,SAAW,KAqFpB,IAEe6B,EAFWlC,EAAiBmC,cCnFrCC,cAcJ,SAAAA,EAAYxC,GAAO,IAAAW,EAAA,OAAA5C,OAAAsC,EAAA,EAAAtC,CAAAuC,KAAAkC,IACjB7B,EAAA5C,OAAA0E,EAAA,EAAA1E,CAAAuC,KAAAvC,OAAA2E,EAAA,EAAA3E,CAAAyE,GAAAG,KAAArC,KAAMN,KAdRvB,MAAQ,CAAEiB,QAAS,IAaAiB,EAmBnBiC,qBAAuB,SAAAC,GACrBlC,EAAKmC,SAAS,CAAEpD,QAASmD,EAAME,OAAOC,SApBrBrC,EAuBnBsC,mBAAqB,SAAAjC,GACnBA,EAAEkC,iBACF,IAAMC,EAAgB,CACpBrB,KAAMnB,EAAKX,MAAM7B,SAEjB4D,QAASpB,EAAKlC,MAAMiB,QACpBkC,OAAQjB,EAAKX,MAAMoD,MAAMC,OAAOC,QAElChB,EAAkBiB,eAAeJ,GACjCxC,EAAKmC,SAAS,CAAEpD,QAAS,MAhCRiB,EAmCnB6C,gBAAkB,SAAAC,GAChB,IACMC,EAAWC,KAAKC,QACnB,IAAIC,MAAOC,UAAY,IAAID,KAAKJ,GAAWK,WAAa,KAiB3D,OAfIJ,EAAW,EAEJ,cACAA,EAAW,IAAMA,EAAW,EAE/B,GAAAjE,OAAMiE,EAAN,gBACGA,EAAW,MAAWA,EAAW,GAEpC,GAAAjE,OAAMkE,KAAKC,MAAMF,EAAW,IAA5B,cACGA,EAAW,OAAgBA,EAAW,KAEzC,GAAAjE,OAAMkE,KAAKC,MAAMF,EAAQ,MAAzB,aAEA,GAAAjE,OAAM,IAAIoE,KAAKJ,KArDN9C,EA0DnBoD,eAAiB,SAAAzE,GACf,IAAM0E,EAAcrD,EAAKX,MAAM7B,SAE/B,OAAOmB,EAAS2E,IAAI,SAACvE,EAASwE,EAAGC,GAAb,OAClBC,EAAAC,EAAAC,cAAA,MACEC,IAAK7E,EAAQ8E,GACbC,MAAO,CAAEC,aAAcP,EAAIxF,OAAS,IAAMuF,EAAI,QAAU,QACxDS,UAAWjF,EAAQkF,SAAWZ,EAAc,OAAS,WAErDI,EAAAC,EAAAC,cAAA,OACEO,IAAI,6CACJC,IAAI,gBAENV,EAAAC,EAAAC,cAAA,SACG5E,EAAQqC,QACTqC,EAAAC,EAAAC,cAAA,WACAF,EAAAC,EAAAC,cAAA,aAAQ3D,EAAK6C,gBAAgB9D,EAAQ+D,iBA1E1B9C,EAgFnBoE,eAAiB,WACfpE,EAAKqE,YAAYC,eAAe,CAAEC,SAAU,YA/E5CvE,EAAKwE,iBAFYxE,gFAXF,IAAAyE,EAAA9E,KACfA,KAAK+E,wBAAwB,WAC3B/C,EAAkBgD,cAChB,KAEAF,EAAKpF,MAAMoD,MAAMC,OAAOC,UAG5BhB,EAAkBjB,QAAQf,KAAKN,MAAMoD,MAAMC,OAAOC,yEAQ5BiC,GACtB,IAAMC,EAAYlF,KAClBmF,WAAW,WACT,GAAkC,IAA9BnD,EAAkB7D,QAGpB,OAFAH,QAAQC,IAAI,2BACZgH,IAGAjH,QAAQC,IAAI,0BACZiH,EAAUH,wBAAwBE,IAEnC,iDAqEHjF,KAAKyE,8DAILzE,KAAKyE,mEAGmBW,GAAU,IAAAC,EAAArF,KAC9BA,KAAKN,MAAMoD,MAAMC,OAAOC,SAAWoC,EAAStC,MAAMC,OAAOC,SAC3DhB,EAAkBsD,aAClBtF,KAAK+E,wBAAwB,WAC3B/C,EAAkBgD,cAChBK,EAAK3F,MAAM7B,SACXuH,EAAStC,MAAMC,OAAOC,UAG1BhB,EAAkBjB,QAAQqE,EAAStC,MAAMC,OAAOC,0CAI3C,IAAAuC,EAAAvF,KACP,OACE8D,EAAAC,EAAAC,cAACwB,EAAD,KACE1B,EAAAC,EAAAC,cAAA,OAAKK,UAAU,YACbP,EAAAC,EAAAC,cAAA,MAAIE,GAAG,YACJlE,KAAKN,MAAMV,UAAYgB,KAAKyD,eAAezD,KAAKN,MAAMV,UACvD8E,EAAAC,EAAAC,cAAA,OACEG,MAAO,CAAEsB,MAAO,OAAQC,MAAO,QAC/BC,IAAK,SAAAC,GACHL,EAAKb,YAAckB,OAK3B9B,EAAAC,EAAAC,cAAA,OAAKK,UAAU,iBACbP,EAAAC,EAAAC,cAAA,QAAM6B,SAAU7F,KAAK2C,oBACnBmB,EAAAC,EAAAC,cAAA,OAAKK,UAAU,QACbP,EAAAC,EAAAC,cAAA,SACE8B,SAAU9F,KAAKsC,qBACfI,MAAO1C,KAAK7B,MAAMiB,QAClB2G,UAAQ,EACR7B,GAAG,qBACH1F,KAAK,OACLwH,YAAY,0BAEdlC,EAAAC,EAAAC,cAAA,KAAGK,UAAU,6BAA6B4B,cAAY,SACtDnC,EAAAC,EAAAC,cAAA,UAAQE,GAAG,sBAAsBG,UAAU,UACzCP,EAAAC,EAAAC,cAAA,KAAGK,UAAU,oBAAoB4B,cAAY,qBAlJ1CC,IAAMC,WAmKVpF,cAPS,SAAA5C,GACtB,MAAO,CACLN,SAAUM,EAAMiI,KAAKvI,SACrBmB,SAAUb,EAAMiB,QAAQJ,WAIb+B,CAAyBmB,GC5JzBmE,EANI,kBACjBvC,EAAAC,EAAAC,cAACwB,EAAD,KACE1B,EAAAC,EAAAC,cAACsC,EAAA,EAAD,CAAOC,OAAK,EAACjG,KAAK,YAAY4E,UAAWhD,wCCEhCxD,EAAc,SAACb,EAAUD,GACpC,MAAO,CACLY,KRXwB,eQYxBZ,MAAOA,EACPC,SAAUA,IAIDc,EAAW,SAAAb,GACtB,MAAO,CACLU,KRlBqB,YQmBrBV,MAAOA,IAIE0I,EAAS,WAIpB,OAHAC,aAAaC,WAAW,SACxBD,aAAaC,WAAW,YACxBD,aAAaC,WAAW,kBACjB,CACLlI,KR3BuB,gBQ+BdmI,EAAmB,SAAAC,GAC9B,OAAO,SAAAC,GACL1B,WAAW,WACT0B,EAASL,MACS,IAAjBI,KAIP5I,QAAQC,IAAI,SAEL,ICnBM6I,EAAe,SAACjJ,EAAUD,GACrC,OAAO,SAAAiJ,GACLE,IAAMC,SAASC,eAAiB,cAChCF,IAAMC,SAASE,eAAiB,YAChCH,IAAMC,SAASG,QAAU,CACvBC,eAAgB,mBAChBC,cAAa,SAAAlI,OAAWvB,IAE1BmJ,IACGO,IADH,GAAAnI,OACUS,EADV,oBAAAT,OACqCtB,IAClC0J,KAAK,SAAAC,GAAG,OAAIX,EAhBV,CACLrI,KTZ6B,oBSa7BS,MAc4CuI,EAAI5G,oBCjBrC6G,EAfC,SAAA/H,GAAK,OACnBoE,EAAAC,EAAAC,cAAC0D,EAAA,EAAD,CAASC,GAAE,GAAAxI,OAAKO,EAAMkI,SAAWzD,MAAO,CAAE0D,MAAO,SAC/C/D,EAAAC,EAAAC,cAAA,MAAIK,UAAU,WACZP,EAAAC,EAAAC,cAAA,OAAKK,UAAU,QACbP,EAAAC,EAAAC,cAAA,QAAMK,UAAS,kBAAAlF,OAAoBO,EAAMoI,UACzChE,EAAAC,EAAAC,cAAA,OAAKO,IAAK7E,EAAMqI,OAAQvD,IAAI,KAC5BV,EAAAC,EAAAC,cAAA,OAAKK,UAAU,QACbP,EAAAC,EAAAC,cAAA,KAAGK,UAAU,QAAQ3E,EAAMsI,WCF/BC,EAAUnE,EAAAC,EAAAC,cAACkE,EAAA,EAAD,CAAM1J,KAAK,UAAU2F,MAAO,CAAEgE,SAAU,IAAMC,MAAI,IAE5DC,6MACJlK,MAAQ,CACNmK,WAAW,KA8BbC,WAAa,WACXlI,EAAKmC,SAAS,CAAE8F,WAAYjI,EAAKlC,MAAMmK,eAGzCE,aAAe,SAAA9H,GACbA,EAAEkC,iBACEvC,EAAKlC,MAAMmK,UACbjI,EAAKX,MAAM+I,MAAM/H,EAAE+B,OAAO5E,SAAS6E,MAAOhC,EAAE+B,OAAOiG,SAAShG,OAE5DrC,EAAKX,MAAMiJ,OACTjI,EAAE+B,OAAO5E,SAAS6E,MAClBhC,EAAE+B,OAAOmG,MAAMlG,MACfhC,EAAE+B,OAAOiG,SAAShG,MAClBhC,EAAE+B,OAAOoG,UAAUnG,4FAvCvB,IAAMwC,EAAYlF,KAClBmF,WAAW,WAEmB,OAA1BD,EAAUxF,MAAM9B,YACUU,IAA1B4G,EAAUxF,MAAM9B,OAQhBI,QAAQC,IAAI,yCACZiH,EAAU4D,sBAPV5D,EAAUxF,MAAMoH,aACd5B,EAAUxF,MAAM7B,SAChBqH,EAAUxF,MAAM9B,QAOnB,iDAIHoC,KAAK8I,gEAIL9I,KAAKN,MAAMqJ,2CAqBJ,IAAAjE,EAAA9E,KACHgJ,EAAchJ,KAAKN,MAAMT,MAAM0E,IAAI,SAAAsF,GACrCjL,QAAQC,IAAI6G,EAAKpF,MAAMT,OACvBjB,QAAQC,IAAIgL,GAIZ,IAAMC,EAAUD,EAAEE,aAAaC,OAC7B,SAAA1G,GAAK,OAAIA,IAAUoC,EAAKpF,MAAM7B,WAGhC,OADAG,QAAQC,IAAIiL,GAEVpF,EAAAC,EAAAC,cAACqF,EAAD,CACEpF,IAAKgF,EAAE/E,GAEP8D,KAAMkB,EACNnB,OAAO,8CACPD,OAAO,OACPF,QAAO,IAAAzI,OAAM8J,EAAE/E,QAIrB,OACEJ,EAAAC,EAAAC,cAAA,OAAKE,GAAG,aACNJ,EAAAC,EAAAC,cAAA,OAAKE,GAAG,WACNJ,EAAAC,EAAAC,cAAA,OAAKK,UAAU,QACbP,EAAAC,EAAAC,cAAA,OACEE,GAAG,cAEHK,IAAI,6GACJF,UAAU,SACVG,IAAI,KAENV,EAAAC,EAAAC,cAAA,SAAIhE,KAAKN,MAAM7B,UACfiG,EAAAC,EAAAC,cAAA,KACEK,UAAU,mCACV4B,cAAY,SAEdnC,EAAAC,EAAAC,cAAA,OAAKE,GAAG,kBACNJ,EAAAC,EAAAC,cAAA,UACEF,EAAAC,EAAAC,cAAA,MAAIE,GAAG,gBAAgBG,UAAU,UAC/BP,EAAAC,EAAAC,cAAA,QAAMK,UAAU,kBADlB,IACqCP,EAAAC,EAAAC,cAAA,oBAErCF,EAAAC,EAAAC,cAAA,MAAIE,GAAG,eACLJ,EAAAC,EAAAC,cAAA,QAAMK,UAAU,kBADlB,IACqCP,EAAAC,EAAAC,cAAA,kBAErCF,EAAAC,EAAAC,cAAA,MAAIE,GAAG,eACLJ,EAAAC,EAAAC,cAAA,QAAMK,UAAU,kBADlB,IACqCP,EAAAC,EAAAC,cAAA,kBAErCF,EAAAC,EAAAC,cAAA,MAAIE,GAAG,kBACLJ,EAAAC,EAAAC,cAAA,QAAMK,UAAU,kBADlB,IACqCP,EAAAC,EAAAC,cAAA,uBAIzCF,EAAAC,EAAAC,cAAA,OAAKE,GAAG,YACLlE,KAAKN,MAAM3B,QACV+F,EAAAC,EAAAC,cAACoE,EAAA,EAAD,CAAMkB,UAAWrB,IACfjI,KAAKN,MAAM6J,gBACbzF,EAAAC,EAAAC,cAAA,UAAQwF,QAAS,kBAAM1E,EAAKpF,MAAM8G,UAAUnC,UAAU,WACpDP,EAAAC,EAAAC,cAAA,uBAGFF,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,QAAMyF,OAAO,OAAO5D,SAAU7F,KAAKwI,cAChCxI,KAAK7B,MAAMmK,UACVxE,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,SACEgE,KAAK,WACLxJ,KAAK,OACLwH,YAAY,aAEdlC,EAAAC,EAAAC,cAAA,SACEgE,KAAK,WACLxJ,KAAK,WACLwH,YAAY,cAIhBlC,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,SACEgE,KAAK,WACLxJ,KAAK,OACLwH,YAAY,aAEdlC,EAAAC,EAAAC,cAAA,SAAOgE,KAAK,QAAQxJ,KAAK,QAAQwH,YAAY,UAC7ClC,EAAAC,EAAAC,cAAA,SACEgE,KAAK,WACLxJ,KAAK,WACLwH,YAAY,aAEdlC,EAAAC,EAAAC,cAAA,SACEgE,KAAK,YACLxJ,KAAK,WACLwH,YAAY,sBAKlBlC,EAAAC,EAAAC,cAAA,UAAQxF,KAAK,UAAb,iBAGFsF,EAAAC,EAAAC,cAAA,UAAQwF,QAASxJ,KAAKuI,YAAtB,cAMVzE,EAAAC,EAAAC,cAAA,OAAKE,GAAG,UACNJ,EAAAC,EAAAC,cAAA,SAAO0F,QAAQ,IACb5F,EAAAC,EAAAC,cAAA,KAAGK,UAAU,eAAe4B,cAAY,UAE1CnC,EAAAC,EAAAC,cAAA,SAAOxF,KAAK,OAAOwH,YAAY,qBAEjClC,EAAAC,EAAAC,cAAA,OAAKE,GAAG,YACNJ,EAAAC,EAAAC,cAAA,UAAKgF,IAEPlF,EAAAC,EAAAC,cAAA,OAAKE,GAAG,cACNJ,EAAAC,EAAAC,cAAA,UAAQE,GAAG,UAAUsF,QAAS,kBAAM1E,EAAKhG,qBACvCgF,EAAAC,EAAAC,cAAA,KAAGK,UAAU,wBAAwB4B,cAAY,SACjDnC,EAAAC,EAAAC,cAAA,4BAEFF,EAAAC,EAAAC,cAAA,UAAQE,GAAG,YACTJ,EAAAC,EAAAC,cAAA,KAAGK,UAAU,kBAAkB4B,cAAY,SAC3CnC,EAAAC,EAAAC,cAAA,kCA7KYkC,IAAMC,WA4MfpF,cAvBS,SAAA5C,GACtB,MAAO,CACLoL,gBAAsC,OAArBpL,EAAMiI,KAAKxI,MAC5BG,QAASI,EAAMiI,KAAKrI,QACpBH,MAAOO,EAAMiI,KAAKxI,MAClBC,SAAUM,EAAMiI,KAAKvI,SACrBoB,MAAOd,EAAMiB,QAAQH,QAIE,SAAA4H,GACzB,MAAO,CACL4B,MAAO,SAACkB,EAAUjB,GAAX,OACL7B,EHhKmB,SAAChJ,EAAU6K,GAClC,OAAO,SAAA7B,GACLA,EAzCK,CACLrI,KRNsB,eQ+CtBuI,IACG6C,KADH,GAAAzK,OACWS,EADX,qBACwC,CACpC/B,SAAUA,EACV6K,SAAUA,IAEXnB,KAAK,SAAAC,GACJ,IAAM5J,EAAQ4J,EAAI5G,KAAKqD,IACjB4F,EAAiB,IAAItG,MAAK,IAAIA,MAAOC,UAAY,MACvDiD,aAAaqD,QAAQ,QAASlM,GAC9B6I,aAAaqD,QAAQ,WAAYjM,GACjC4I,aAAaqD,QAAQ,iBAAkBD,GACvChD,EAASnI,EAAYb,EAAUD,IAC/BiJ,EAASF,EAAiB,SAE3BoD,MAAM,SAAAjI,GACL+E,EAASlI,EAASmD,OG8IXkI,CAAkBL,EAAUjB,KACvClC,OAAQ,kBAAMK,EAASmD,MACvBrB,OAAQ,SAAC9K,EAAU+K,EAAOqB,EAAWpB,GAA7B,OACNhC,EH5IoB,SAAChJ,EAAU+K,EAAOqB,EAAWpB,GACrD,OAAO,SAAAhC,GACLA,EAhEK,CACLrI,KRNsB,eQsEtBuI,IACG6C,KADH,GAAAzK,OACWS,EADX,4BAC+C,CAC3C/B,SAAUA,EACV+K,MAAOA,EACPqB,UAAWA,EACXpB,UAAWA,IAEZtB,KAAK,SAAAC,GACJ,IAAM5J,EAAQ4J,EAAI5G,KAAKqD,IACjB4F,EAAiB,IAAItG,MAAK,IAAIA,MAAOC,UAAY,MACvDiD,aAAaqD,QAAQ,QAASlM,GAC9B6I,aAAaqD,QAAQ,WAAYjM,GACjC4I,aAAaqD,QAAQ,iBAAkBD,GACvChD,EAASnI,EAAYb,EAAUD,IAC/BiJ,EAASF,EAAiB,SAE3BoD,MAAM,SAAAjI,GACL+E,EAASlI,EAASmD,OGwHXkI,CAAmBnM,EAAU+K,EAAOqB,EAAWpB,KAC1DE,QAAS,kBAAMlC,EC7MV,CACLrI,KZA+B,yBW6M/BsI,aAAc,SAACjJ,EAAUD,GAAX,OACZiJ,EAASqD,EAA4BrM,EAAUD,OAItCmD,CAA6CsH,YEjNtD8B,mLAEF,OAAyB,OAArBnK,KAAKN,MAAM9B,MACNkG,EAAAC,EAAAC,cAACoG,EAAA,EAAD,CAAUzC,GAAG,MAGpB7D,EAAAC,EAAAC,cAAA,OAAKK,UAAU,mBACY,OAAxBrE,KAAKN,MAAM7B,SACViG,EAAAC,EAAAC,cAACwB,EAAD,KAEE1B,EAAAC,EAAAC,cAAA,OACEO,IAAI,6GACJC,IAAI,KAENV,EAAAC,EAAAC,cAAA,sBAAchE,KAAKN,MAAM7B,UACzBiG,EAAAC,EAAAC,cAAA,OAAKK,UAAU,gBACbP,EAAAC,EAAAC,cAAA,KAAGK,UAAU,iBAAiB4B,cAAY,SAC1CnC,EAAAC,EAAAC,cAAA,KAAGK,UAAU,gBAAgB4B,cAAY,SACzCnC,EAAAC,EAAAC,cAAA,KAAGK,UAAU,kBAAkB4B,cAAY,WAG7C,aArBUC,IAAMC,WAkCbpF,cAPS,SAAA5C,GACtB,MAAO,CACLN,SAAUM,EAAMiI,KAAKvI,SACrBD,MAAOO,EAAMiI,KAAKxI,QAIPmD,CAAyBoJ,kDC9BlCE,GAAWC,IAAKC,SAMhBC,8MACJrM,MAAQ,CACNsM,UAAW,GACX3M,MAAO,QAGT4M,aAAe,SAAAhI,GACbrC,EAAKmC,SAAS,CACZiI,UAAW/H,OAQfiI,aAAe,SAAAjK,GAAK,IACV+J,EAAcpK,EAAKlC,MAAnBsM,UACR/J,EAAEkC,iBACFvC,EAAKX,MAAMkL,KAAKC,eAAe,SAAC/I,EAAKgJ,GACnC,IAAKhJ,EAAK,CACR,IAAMiJ,EAAQtN,OAAAyB,EAAA,EAAAzB,CAAOgN,GAAPtL,OAAA,CAAkBkB,EAAKX,MAAM7B,WAC3CkJ,IAAMC,SAASC,eAAiB,cAChCF,IAAMC,SAASE,eAAiB,YAChCH,IAAMC,SAASG,QAAU,CACvBC,eAAgB,mBAChBC,cAAa,SAAAlI,OAAWkB,EAAKX,MAAM9B,QAErCmJ,IACG6C,KADH,GAAAzK,OACWS,EADX,iBACoC,CAChCZ,SAAU,GACVmK,aAAc4B,IAEfxD,KAAK,SAAAC,GACJnH,EAAKX,MAAMsL,QAAQC,KAAnB,IAAA9L,OAA4BqI,EAAI5G,KAAKsD,KACrC7D,EAAKX,MAAMX,oBACXsB,EAAKX,MAAMoH,aAAazG,EAAKX,MAAM7B,SAAUwC,EAAKX,MAAM9B,SAEzDmM,MAAM,SAAAjI,GACL9D,QAAQF,MAAMgE,GACdzB,EAAKmC,SAAS,CACZ1E,MAAOgE,6FA5BjB9B,KAAKN,MAAMkL,KAAKC,kDAmCT,IApDQK,EAoDRC,EAMHnL,KAAKN,MAAMkL,KAJbQ,EAFKD,EAELC,kBACAC,EAHKF,EAGLE,eACAC,EAJKH,EAILG,cAIIC,GACJC,EATKL,EAKLK,gBAIe,aAAeF,EAAc,YAC9C,OACExH,EAAAC,EAAAC,cAACyH,EAAA,EAAD,CAAMC,OAAO,SAAS7F,SAAU7F,KAAK2K,cAClC3K,KAAK7B,MAAML,MAAX,GAAAqB,OAAsBa,KAAK7B,MAAML,OAAU,KAC5CgG,EAAAC,EAAAC,cAACqG,GAAD,CACEsB,eAAgBJ,EAAgB,QAAU,GAC1CK,KAAML,GAAiB,IAEtBH,EAAkB,WAAY,CAC7BS,MAAO,CACL,CACE9F,UAAU,EACV3G,QACE,mEALPgM,CASCtH,EAAAC,EAAAC,cAAC8H,GAAA,EAAD,CACEC,KAAK,OACL5H,MAAO,CAAE6H,MAAO,QAChBhG,YAAY,YACZF,SAAU9F,KAAK0K,cAEd,MAIP5G,EAAAC,EAAAC,cAACqG,GAAD,KACEvG,EAAAC,EAAAC,cAACiI,GAAA,EAAD,CACEzN,KAAK,UACL0N,SAAS,SACTC,UA5FOjB,EA4FaG,IA3FvB5N,OAAO4D,KAAK6J,GAAakB,KAAK,SAAAC,GAAK,OAAInB,EAAYmB,OAwFlD,yBArF0BnG,IAAMC,WAkGpCmG,GAAchC,IAAKiC,QAALjC,CAAcE,IAiBnBgC,gBACbzL,YAhBsB,SAAA5C,GACtB,MAAO,CACLP,MAAOO,EAAMiI,KAAKxI,MAClBC,SAAUM,EAAMiI,KAAKvI,WAIE,SAAAgJ,GACzB,MAAO,CACL9H,kBAAmB,kBAAM8H,EFnHpB,CACLrI,KZLgC,0BcwHhCsI,aAAc,SAACjJ,EAAUD,GAAX,OACZiJ,EAASqD,EAA4BrM,EAAUD,OAKnDmD,CAGEuL,KCnHWG,oLAbX,OACE3I,EAAAC,EAAAC,cAAC0I,EAAA,EAAD,CACEC,UAAQ,EACRC,OAAQ,KACRC,QAAS7M,KAAKN,MAAMoN,UACpBC,SAAU/M,KAAKN,MAAMsB,OAErB8C,EAAAC,EAAAC,cAACsG,GAAD,cATmBpE,IAAMC,WCS3B6G,uBAKJ,SAAAA,EAAYtN,GAAO,IAAAW,EAAA,OAAA5C,OAAAsC,EAAA,EAAAtC,CAAAuC,KAAAgN,GACjB3M,EAAA5C,OAAA0E,EAAA,EAAA1E,CAAAuC,KAAAvC,OAAA2E,EAAA,EAAA3E,CAAAuP,GAAA3K,KAAArC,KAAMN,IACNsC,EAAkBiL,aAChB5M,EAAKX,MAAMH,YAAY2N,KAAvBzP,OAAA0P,EAAA,EAAA1P,QAAA0P,EAAA,EAAA1P,CAAA4C,KACAA,EAAKX,MAAML,WAAW6N,KAAtBzP,OAAA0P,EAAA,EAAA1P,QAAA0P,EAAA,EAAA1P,CAAA4C,MAJeA,mFAHjBL,KAAKN,MAAM0N,oEAWJ,IAAAtI,EAAA9E,KAGP,OAFAhC,QAAQC,IAAI,QAAS+B,KAAKN,MAAM2N,eAChCrP,QAAQC,IAAI,QAAsC,OAA7B+B,KAAKN,MAAM2N,eAE9BvJ,EAAAC,EAAAC,cAACsJ,EAAA,EAAD,KACExJ,EAAAC,EAAAC,cAAA,OAAKE,GAAG,SAAR,yCACyCJ,EAAAC,EAAAC,cAACuJ,EAAD,MACvCzJ,EAAAC,EAAAC,cAAA,OAAKK,UAAU,WACbP,EAAAC,EAAAC,cAACwJ,GAAD,CACEV,UAAW9M,KAAKN,MAAMb,iBACtBmC,MAAO,kBAAM8D,EAAKpF,MAAMX,uBAE1B+E,EAAAC,EAAAC,cAACyJ,EAAD,MACA3J,EAAAC,EAAAC,cAAC0J,EAAD,gBA1BMxH,IAAMC,YAkDTpF,eAhBS,SAAA5C,GACtB,MAAO,CACLU,iBAAkBV,EAAMwP,IAAI9O,iBAC5BwO,cAAelP,EAAMiI,KAAKxI,QAIH,SAAAiJ,GACzB,MAAO,CACLuG,gBAAiB,kBAAMvG,ERqClB,SAAAA,GACL,IAAMjJ,EAAQ6I,aAAamH,QAAQ,SAC7B/P,EAAW4I,aAAamH,QAAQ,YACtC,QAActP,IAAVV,EACFiJ,EAASL,SACJ,CACL,IAAMqD,EAAiB,IAAItG,KAAKkD,aAAamH,QAAQ,mBACjD/D,GAAkB,IAAItG,KACxBsD,EAASL,MAETK,EAASnI,EAAYb,EAAUD,IAC/BiJ,EACEF,GACGkD,EAAerG,WAAY,IAAID,MAAOC,WAAa,WQjD5DzE,kBAAmB,kBAAM8H,EJhDpB,CACLrI,KZLgC,0BgBqDhCa,WAAY,SAAAD,GAAO,OAAIyH,EPtDD,SAAAzH,GACxB,MAAO,CACLZ,KTAuB,cSCvBY,QAASA,GOmDuB8K,CAA0B9K,KAC1DG,YAAa,SAAAP,GAAQ,OAAI6H,EPhDF,SAAA7H,GACzB,MAAO,CACLR,KTNwB,eSOxBQ,SAAUA,GO6CwBkL,CAA2BlL,OAIlD+B,CAA6CiM,ICpDtDa,GAAmBC,OAAOC,sCAAwCC,IAwBxE,IAAMC,GAtBN,WACE,IAAMC,EAAcC,YAAgB,CAClC/H,KAAMgI,EACNT,IAAKU,EACLjP,QAASkP,IAeX,OAZcC,YACZL,EACAL,GAAiBW,YAAgBC,OAavBC,GAERC,GACJ7K,EAAAC,EAAAC,cAAC4K,EAAA,EAAD,CAAUX,MAAOA,IACfnK,EAAAC,EAAAC,cAAC6K,GAAD,OAIJC,IAASC,OAAOJ,GAAKK,SAASC,eAAe","file":"static/js/main.8816360f.chunk.js","sourcesContent":["export const updateObject = (oldObject, updatedProperties) => {\n  return {\n    ...oldObject,\n    ...updatedProperties\n  };\n};\n","import * as actionTypes from \"../actions/actionTypes\";\nimport { updateObject } from \"../utility\";\n\nconst initialState = {\n  token: null,\n  username: null,\n  error: null,\n  loading: false\n};\n\nconst authStart = (state, action) => {\n  return updateObject(state, {\n    error: null,\n    loading: true\n  });\n};\nconsole.log(\"here\");\nconst authSuccess = (state, action) => {\n  return updateObject(state, {\n    token: action.token,\n    username: action.username,\n    error: null,\n    loading: false\n  });\n};\n\nconst authFail = (state, action) => {\n  return updateObject(state, {\n    error: action.error,\n    loading: false\n  });\n};\n\nconst authLogout = (state, action) => {\n  return updateObject(state, {\n    token: null,\n    username: null\n  });\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.AUTH_START:\n      return authStart(state, action);\n    case actionTypes.AUTH_SUCCESS:\n      return authSuccess(state, action);\n    case actionTypes.AUTH_FAIL:\n      return authFail(state, action);\n    case actionTypes.AUTH_LOGOUT:\n      return authLogout(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","export const AUTH_START = \"AUTH_START\";\nexport const AUTH_SUCCESS = \"AUTH_SUCCESS\";\nexport const AUTH_FAIL = \"AUTH_FAIL\";\nexport const AUTH_LOGOUT = \"AUTH_LOGOUT\";\nexport const OPEN_ADD_CHAT_POPUP = \"OPEN_ADD_CHAT_POPUP\";\nexport const CLOSE_ADD_CHAT_POPUP = \"CLOSE_ADD_CHAT_POPUP\";\nexport const ADD_MESSAGE = \"ADD_MESSAGE\";\nexport const SET_MESSAGES = \"SET_MESSAGES\";\nexport const GET_CHATS_SUCCESS = \"GET_CHATS_SUCCESS\";\n","import * as actionTypes from \"../actions/actionTypes\";\nimport { updateObject } from \"../utility\";\n\nconst initialState = {\n  showAddChatPopup: false\n};\n\nconst openAddChatPopup = (state, action) => {\n  return updateObject(state, { showAddChatPopup: true });\n};\n\nconst closeAddChatPopup = (state, action) => {\n  return updateObject(state, { showAddChatPopup: false });\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.OPEN_ADD_CHAT_POPUP:\n      return openAddChatPopup(state, action);\n    case actionTypes.CLOSE_ADD_CHAT_POPUP:\n      return closeAddChatPopup(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","import * as actionTypes from \"../actions/actionTypes\";\nimport { updateObject } from \"../utility\";\n\nconst initialState = {\n  messages: [],\n  chats: []\n};\n\nconst addMessage = (state, action) => {\n  return updateObject(state, {\n    messages: [...state.messages, action.message]\n  });\n};\n\nconst setMessages = (state, action) => {\n  return updateObject(state, {\n    messages: action.messages.reverse()\n  });\n};\n\nconst setChats = (state, action) => {\n  return updateObject(state, {\n    chats: action.chats\n  });\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.ADD_MESSAGE:\n      return addMessage(state, action);\n    case actionTypes.SET_MESSAGES:\n      return setMessages(state, action);\n    case actionTypes.GET_CHATS_SUCCESS:\n      return setChats(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","const Hoc = props => props.children;\n\nexport default Hoc;\n","let DEBUG = true;\nlet HOST_URL = \"https://justdjango-chat.herokuapp.com\";\nlet SOCKET_URL = \"wss://justdjango-chat.herokuapp.com\";\nif (DEBUG) {\n  HOST_URL = \"http://127.0.0.1:8000\";\n  SOCKET_URL = \"ws://127.0.0.1:8000\";\n}\n\nexport { HOST_URL, SOCKET_URL };\n","import { SOCKET_URL } from \"./settings\";\n\nclass WebSocketService {\n  static instance = null;\n  callbacks = {};\n\n  static getInstance() {\n    if (!WebSocketService.instance) {\n      WebSocketService.instance = new WebSocketService();\n    }\n    return WebSocketService.instance;\n  }\n\n  constructor() {\n    this.socketRef = null;\n  }\n\n  connect(chatUrl) {\n    const path = `${SOCKET_URL}/ws/chat/${chatUrl}/`;\n    this.socketRef = new WebSocket(path);\n    this.socketRef.onopen = () => {\n      console.log(\"WebSocket open\");\n    };\n    this.socketRef.onmessage = e => {\n      this.socketNewMessage(e.data);\n    };\n    this.socketRef.onerror = e => {\n      console.log(e.message);\n    };\n    this.socketRef.onclose = () => {\n      console.log(\"WebSocket closed let's reopen\");\n      this.connect();\n    };\n  }\n\n  disconnect() {\n    this.socketRef.close();\n  }\n\n  socketNewMessage(data) {\n    const parsedData = JSON.parse(data);\n    const command = parsedData.command;\n    if (Object.keys(this.callbacks).length === 0) {\n      return;\n    }\n    if (command === \"messages\") {\n      this.callbacks[command](parsedData.messages);\n    }\n    if (command === \"new_message\") {\n      this.callbacks[command](parsedData.message);\n    }\n  }\n\n  fetchMessages(username, chatId) {\n    this.sendMessage({\n      command: \"fetch_messages\",\n      username: username,\n      chatId: chatId\n    });\n  }\n\n  newChatMessage(message) {\n    this.sendMessage({\n      command: \"new_message\",\n      from: message.from,\n      message: message.content,\n      chatId: message.chatId\n    });\n  }\n\n  addCallbacks(messagesCallback, newMessageCallback) {\n    this.callbacks[\"messages\"] = messagesCallback;\n    this.callbacks[\"new_message\"] = newMessageCallback;\n  }\n\n  sendMessage(data) {\n    try {\n      this.socketRef.send(JSON.stringify({ ...data }));\n    } catch (err) {\n      console.log(err.message);\n    }\n  }\n\n  state() {\n    return this.socketRef.readyState;\n  }\n}\n\nconst WebSocketInstance = WebSocketService.getInstance();\n\nexport default WebSocketInstance;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport WebSocketInstance from \"../websocket\";\nimport Hoc from \"../hoc/hoc\";\n\nclass Chat extends React.Component {\n  state = { message: \"\" };\n\n  initialiseChat() {\n    this.waitForSocketConnection(() => {\n      WebSocketInstance.fetchMessages(\n        \"io\",\n        // this.props.username,\n        this.props.match.params.chatID\n      );\n    });\n    WebSocketInstance.connect(this.props.match.params.chatID);\n  }\n\n  constructor(props) {\n    super(props);\n    this.initialiseChat();\n  }\n\n  waitForSocketConnection(callback) {\n    const component = this;\n    setTimeout(function() {\n      if (WebSocketInstance.state() === 1) {\n        console.log(\"Connection is made\");\n        callback();\n        return;\n      } else {\n        console.log(\"wait for connection...\");\n        component.waitForSocketConnection(callback);\n      }\n    }, 100);\n  }\n\n  messageChangeHandler = event => {\n    this.setState({ message: event.target.value });\n  };\n\n  sendMessageHandler = e => {\n    e.preventDefault();\n    const messageObject = {\n      from: this.props.username,\n      // from: \"io\",\n      content: this.state.message,\n      chatId: this.props.match.params.chatID\n    };\n    WebSocketInstance.newChatMessage(messageObject);\n    this.setState({ message: \"\" });\n  };\n\n  renderTimestamp = timestamp => {\n    let prefix = \"\";\n    const timeDiff = Math.round(\n      (new Date().getTime() - new Date(timestamp).getTime()) / 60000\n    );\n    if (timeDiff < 1) {\n      // less than one minute ago\n      prefix = \"just now...\";\n    } else if (timeDiff < 60 && timeDiff > 1) {\n      // less than sixty minutes ago\n      prefix = `${timeDiff} minutes ago`;\n    } else if (timeDiff < 24 * 60 && timeDiff > 60) {\n      // less than 24 hours ago\n      prefix = `${Math.round(timeDiff / 60)} hours ago`;\n    } else if (timeDiff < 31 * 24 * 60 && timeDiff > 24 * 60) {\n      // less than 7 days ago\n      prefix = `${Math.round(timeDiff / (60 * 24))} days ago`;\n    } else {\n      prefix = `${new Date(timestamp)}`;\n    }\n    return prefix;\n  };\n\n  renderMessages = messages => {\n    const currentUser = this.props.username;\n    // const currentUser = \"io\";\n    return messages.map((message, i, arr) => (\n      <li\n        key={message.id}\n        style={{ marginBottom: arr.length - 1 === i ? \"300px\" : \"15px\" }}\n        className={message.author === currentUser ? \"sent\" : \"replies\"}\n      >\n        <img\n          src=\"http://emilcarlsson.se/assets/mikeross.png\"\n          alt=\"profile-pic\"\n        />\n        <p>\n          {message.content}\n          <br />\n          <small>{this.renderTimestamp(message.timestamp)}</small>\n        </p>\n      </li>\n    ));\n  };\n\n  scrollToBottom = () => {\n    this.messagesEnd.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  componentDidMount() {\n    this.scrollToBottom();\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  componentWillReceiveProps(newProps) {\n    if (this.props.match.params.chatID !== newProps.match.params.chatID) {\n      WebSocketInstance.disconnect();\n      this.waitForSocketConnection(() => {\n        WebSocketInstance.fetchMessages(\n          this.props.username,\n          newProps.match.params.chatID\n        );\n      });\n      WebSocketInstance.connect(newProps.match.params.chatID);\n    }\n  }\n\n  render() {\n    return (\n      <Hoc>\n        <div className=\"messages\">\n          <ul id=\"chat-log\">\n            {this.props.messages && this.renderMessages(this.props.messages)}\n            <div\n              style={{ float: \"left\", clear: \"both\" }}\n              ref={el => {\n                this.messagesEnd = el;\n              }}\n            />\n          </ul>\n        </div>\n        <div className=\"message-input\">\n          <form onSubmit={this.sendMessageHandler}>\n            <div className=\"wrap\">\n              <input\n                onChange={this.messageChangeHandler}\n                value={this.state.message}\n                required\n                id=\"chat-message-input\"\n                type=\"text\"\n                placeholder=\"Write your message...\"\n              />\n              <i className=\"fa fa-paperclip attachment\" aria-hidden=\"true\" />\n              <button id=\"chat-message-submit\" className=\"submit\">\n                <i className=\"fa fa-paper-plane\" aria-hidden=\"true\" />\n              </button>\n            </div>\n          </form>\n        </div>\n      </Hoc>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.auth.username,\n    messages: state.message.messages\n  };\n};\n\nexport default connect(mapStateToProps)(Chat);\n","import React from \"react\";\nimport { Route } from \"react-router-dom\";\nimport Hoc from \"./hoc/hoc\";\n\nimport Chat from \"./containers/Chat\";\n\nconst BaseRouter = () => (\n  <Hoc>\n    <Route exact path=\"/:chatID/\" component={Chat} />\n  </Hoc>\n);\n\nexport default BaseRouter;\n","import axios from \"axios\";\nimport * as actionTypes from \"./actionTypes\";\nimport { HOST_URL } from \"../../settings\";\n\nexport const authStart = () => {\n  return {\n    type: actionTypes.AUTH_START\n  };\n};\n\nexport const authSuccess = (username, token) => {\n  return {\n    type: actionTypes.AUTH_SUCCESS,\n    token: token,\n    username: username\n  };\n};\n\nexport const authFail = error => {\n  return {\n    type: actionTypes.AUTH_FAIL,\n    error: error\n  };\n};\n\nexport const logout = () => {\n  localStorage.removeItem(\"token\");\n  localStorage.removeItem(\"username\");\n  localStorage.removeItem(\"expirationDate\");\n  return {\n    type: actionTypes.AUTH_LOGOUT\n  };\n};\n\nexport const checkAuthTimeout = expirationTime => {\n  return dispatch => {\n    setTimeout(() => {\n      dispatch(logout());\n    }, expirationTime * 1000);\n  };\n};\n\nconsole.log(\"here1\");\n\nexport const authLogin = (username, password) => {\n  return dispatch => {\n    dispatch(authStart());\n    axios\n      .post(`${HOST_URL}/rest-auth/login/`, {\n        username: username,\n        password: password\n      })\n      .then(res => {\n        const token = res.data.key;\n        const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\n        localStorage.setItem(\"token\", token);\n        localStorage.setItem(\"username\", username);\n        localStorage.setItem(\"expirationDate\", expirationDate);\n        dispatch(authSuccess(username, token));\n        dispatch(checkAuthTimeout(3600));\n      })\n      .catch(err => {\n        dispatch(authFail(err));\n      });\n  };\n};\n\nexport const authSignup = (username, email, password1, password2) => {\n  return dispatch => {\n    dispatch(authStart());\n    axios\n      .post(`${HOST_URL}/rest-auth/registration/`, {\n        username: username,\n        email: email,\n        password1: password1,\n        password2: password2\n      })\n      .then(res => {\n        const token = res.data.key;\n        const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\n        localStorage.setItem(\"token\", token);\n        localStorage.setItem(\"username\", username);\n        localStorage.setItem(\"expirationDate\", expirationDate);\n        dispatch(authSuccess(username, token));\n        dispatch(checkAuthTimeout(3600));\n      })\n      .catch(err => {\n        dispatch(authFail(err));\n      });\n  };\n};\n\nexport const authCheckState = () => {\n  return dispatch => {\n    const token = localStorage.getItem(\"token\");\n    const username = localStorage.getItem(\"username\");\n    if (token === undefined) {\n      dispatch(logout());\n    } else {\n      const expirationDate = new Date(localStorage.getItem(\"expirationDate\"));\n      if (expirationDate <= new Date()) {\n        dispatch(logout());\n      } else {\n        dispatch(authSuccess(username, token));\n        dispatch(\n          checkAuthTimeout(\n            (expirationDate.getTime() - new Date().getTime()) / 1000\n          )\n        );\n      }\n    }\n  };\n};\n","import axios from \"axios\";\nimport * as actionTypes from \"./actionTypes\";\nimport { HOST_URL } from \"../../settings\";\n\nexport const addMessage = message => {\n  return {\n    type: actionTypes.ADD_MESSAGE,\n    message: message\n  };\n};\n\nexport const setMessages = messages => {\n  return {\n    type: actionTypes.SET_MESSAGES,\n    messages: messages\n  };\n};\n\nconst getUserChatsSuccess = chats => {\n  return {\n    type: actionTypes.GET_CHATS_SUCCESS,\n    chats: chats\n  };\n};\n\nexport const getUserChats = (username, token) => {\n  return dispatch => {\n    axios.defaults.xsrfHeaderName = \"X-CSRFTOKEN\";\n    axios.defaults.xsrfCookieName = \"csrftoken\";\n    axios.defaults.headers = {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Token ${token}`\n    };\n    axios\n      .get(`${HOST_URL}/chat/?username=${username}`)\n      .then(res => dispatch(getUserChatsSuccess(res.data)));\n  };\n};\n","import React from \"react\";\nimport { NavLink } from \"react-router-dom\";\n\nconst Contact = props => (\n  <NavLink to={`${props.chatURL}`} style={{ color: \"#fff\" }}>\n    <li className=\"contact\">\n      <div className=\"wrap\">\n        <span className={`contact-status ${props.status}`} />\n        <img src={props.picURL} alt=\"\" />\n        <div className=\"meta\">\n          <p className=\"name\">{props.name}</p>\n          {/* <p className=\"preview\">You just got LITT up, Mike.</p> */}\n        </div>\n      </div>\n    </li>\n  </NavLink>\n);\n\nexport default Contact;\n","import React from \"react\";\nimport { Spin, Icon } from \"antd\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../store/actions/auth\";\nimport * as navActions from \"../store/actions/nav\";\nimport * as messageActions from \"../store/actions/message\";\nimport Contact from \"../components/Contact\";\n\nconst antIcon = <Icon type=\"loading\" style={{ fontSize: 24 }} spin />;\n\nclass Sidepanel extends React.Component {\n  state = {\n    loginForm: true\n  };\n\n  waitForAuthDetails() {\n    const component = this;\n    setTimeout(function() {\n      if (\n        component.props.token !== null &&\n        component.props.token !== undefined\n      ) {\n        component.props.getUserChats(\n          component.props.username,\n          component.props.token\n        );\n        return;\n      } else {\n        console.log(\"waiting for authentication details...\");\n        component.waitForAuthDetails();\n      }\n    }, 100);\n  }\n\n  componentDidMount() {\n    this.waitForAuthDetails();\n  }\n\n  openAddChatPopup() {\n    this.props.addChat();\n  }\n\n  changeForm = () => {\n    this.setState({ loginForm: !this.state.loginForm });\n  };\n\n  authenticate = e => {\n    e.preventDefault();\n    if (this.state.loginForm) {\n      this.props.login(e.target.username.value, e.target.password.value);\n    } else {\n      this.props.signup(\n        e.target.username.value,\n        e.target.email.value,\n        e.target.password.value,\n        e.target.password2.value\n      );\n    }\n  };\n  // console.log(\"login\", this.props);\n  render() {\n    let activeChats = this.props.chats.map(c => {\n      console.log(this.props.chats);\n      console.log(c);\n      // let result = c.participants.filter(function(value) {\n      //   return value !== this.props.username;\n      // });\n      const partner = c.participants.filter(\n        value => value !== this.props.username\n      );\n      console.log(partner);\n      return (\n        <Contact\n          key={c.id}\n          // name=\"Harveyふぁ\"\n          name={partner}\n          picURL=\"http://emilcarlsson.se/assets/louislitt.png\"\n          status=\"busy\"\n          chatURL={`/${c.id}`}\n        />\n      );\n    });\n    return (\n      <div id=\"sidepanel\">\n        <div id=\"profile\">\n          <div className=\"wrap\">\n            <img\n              id=\"profile-img\"\n              // src=\"http://emilcarlsson.se/assets/mikeross.png\"\n              src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT1HdsqyW6WyD4gkzNWDOYp2dyeLH12-GV_36pGx25KXyvJu9vY&s\"\n              className=\"online\"\n              alt=\"\"\n            />\n            <p>{this.props.username}</p>\n            <i\n              className=\"fa fa-chevron-down expand-button\"\n              aria-hidden=\"true\"\n            />\n            <div id=\"status-options\">\n              <ul>\n                <li id=\"status-online\" className=\"active\">\n                  <span className=\"status-circle\" /> <p>Online</p>\n                </li>\n                <li id=\"status-away\">\n                  <span className=\"status-circle\" /> <p>Away</p>\n                </li>\n                <li id=\"status-busy\">\n                  <span className=\"status-circle\" /> <p>Busy</p>\n                </li>\n                <li id=\"status-offline\">\n                  <span className=\"status-circle\" /> <p>Offline</p>\n                </li>\n              </ul>\n            </div>\n            <div id=\"expanded\">\n              {this.props.loading ? (\n                <Spin indicator={antIcon} />\n              ) : this.props.isAuthenticated ? (\n                <button onClick={() => this.props.logout()} className=\"authBtn\">\n                  <span>Logout</span>\n                </button>\n              ) : (\n                <div>\n                  <form method=\"POST\" onSubmit={this.authenticate}>\n                    {this.state.loginForm ? (\n                      <div>\n                        <input\n                          name=\"username\"\n                          type=\"text\"\n                          placeholder=\"username\"\n                        />\n                        <input\n                          name=\"password\"\n                          type=\"password\"\n                          placeholder=\"password\"\n                        />\n                      </div>\n                    ) : (\n                      <div>\n                        <input\n                          name=\"username\"\n                          type=\"text\"\n                          placeholder=\"username\"\n                        />\n                        <input name=\"email\" type=\"email\" placeholder=\"email\" />\n                        <input\n                          name=\"password\"\n                          type=\"password\"\n                          placeholder=\"password\"\n                        />\n                        <input\n                          name=\"password2\"\n                          type=\"password\"\n                          placeholder=\"password confirm\"\n                        />\n                      </div>\n                    )}\n\n                    <button type=\"submit\">Authenticate</button>\n                  </form>\n\n                  <button onClick={this.changeForm}>Switch</button>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n        <div id=\"search\">\n          <label htmlFor=\"\">\n            <i className=\"fa fa-search\" aria-hidden=\"true\" />\n          </label>\n          <input type=\"text\" placeholder=\"Search Chats...\" />\n        </div>\n        <div id=\"contacts\">\n          <ul>{activeChats}</ul>\n        </div>\n        <div id=\"bottom-bar\">\n          <button id=\"addChat\" onClick={() => this.openAddChatPopup()}>\n            <i className=\"fa fa-user-plus fa-fw\" aria-hidden=\"true\" />\n            <span>Create chat</span>\n          </button>\n          <button id=\"settings\">\n            <i className=\"fa fa-cog fa-fw\" aria-hidden=\"true\" />\n            <span>Settings</span>\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    isAuthenticated: state.auth.token !== null,\n    loading: state.auth.loading,\n    token: state.auth.token,\n    username: state.auth.username,\n    chats: state.message.chats\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    login: (userName, password) =>\n      dispatch(actions.authLogin(userName, password)),\n    logout: () => dispatch(actions.logout()),\n    signup: (username, email, password1, password2) =>\n      dispatch(actions.authSignup(username, email, password1, password2)),\n    addChat: () => dispatch(navActions.openAddChatPopup()),\n    getUserChats: (username, token) =>\n      dispatch(messageActions.getUserChats(username, token))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidepanel);\n","import * as actionTypes from \"./actionTypes\";\n\nexport const openAddChatPopup = () => {\n  return {\n    type: actionTypes.OPEN_ADD_CHAT_POPUP\n  };\n};\n\nexport const closeAddChatPopup = () => {\n  return {\n    type: actionTypes.CLOSE_ADD_CHAT_POPUP\n  };\n};\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\nimport Hoc from \"../hoc/hoc\";\n\nclass Profile extends React.Component {\n  render() {\n    if (this.props.token === null) {\n      return <Redirect to=\"/\" />;\n    }\n    return (\n      <div className=\"contact-profile\">\n        {this.props.username !== null ? (\n          <Hoc>\n            {/* <img src=\"http://emilcarlsson.se/assets/harveyspecter.png\" alt=\"\" /> */}\n            <img\n              src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT1HdsqyW6WyD4gkzNWDOYp2dyeLH12-GV_36pGx25KXyvJu9vY&s\"\n              alt=\"\"\n            />\n            <p>username: {this.props.username}</p>\n            <div className=\"social-media\">\n              <i className=\"fa fa-facebook\" aria-hidden=\"true\" />\n              <i className=\"fa fa-twitter\" aria-hidden=\"true\" />\n              <i className=\"fa fa-instagram\" aria-hidden=\"true\" />\n            </div>\n          </Hoc>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.auth.username,\n    token: state.auth.token\n  };\n};\n\nexport default connect(mapStateToProps)(Profile);\n","import React from \"react\";\nimport { Form, Button, Select } from \"antd\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport * as navActions from \"../store/actions/nav\";\nimport * as messageActions from \"../store/actions/message\";\nimport { HOST_URL } from \"../settings\";\n\nconst FormItem = Form.Item;\n\nfunction hasErrors(fieldsError) {\n  return Object.keys(fieldsError).some(field => fieldsError[field]);\n}\n\nclass HorizontalAddChatForm extends React.Component {\n  state = {\n    usernames: [],\n    error: null\n  };\n\n  handleChange = value => {\n    this.setState({\n      usernames: value\n    });\n  };\n\n  componentDidMount() {\n    this.props.form.validateFields();\n  }\n\n  handleSubmit = e => {\n    const { usernames } = this.state;\n    e.preventDefault();\n    this.props.form.validateFields((err, values) => {\n      if (!err) {\n        const combined = [...usernames, this.props.username];\n        axios.defaults.xsrfHeaderName = \"X-CSRFTOKEN\";\n        axios.defaults.xsrfCookieName = \"csrftoken\";\n        axios.defaults.headers = {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Token ${this.props.token}`\n        };\n        axios\n          .post(`${HOST_URL}/chat/create/`, {\n            messages: [],\n            participants: combined\n          })\n          .then(res => {\n            this.props.history.push(`/${res.data.id}`);\n            this.props.closeAddChatPopup();\n            this.props.getUserChats(this.props.username, this.props.token);\n          })\n          .catch(err => {\n            console.error(err);\n            this.setState({\n              error: err\n            });\n          });\n      }\n    });\n  };\n\n  render() {\n    const {\n      getFieldDecorator,\n      getFieldsError,\n      getFieldError,\n      isFieldTouched\n    } = this.props.form;\n\n    const userNameError =\n      isFieldTouched(\"userName\") && getFieldError(\"userName\");\n    return (\n      <Form layout=\"inline\" onSubmit={this.handleSubmit}>\n        {this.state.error ? `${this.state.error}` : null}\n        <FormItem\n          validateStatus={userNameError ? \"error\" : \"\"}\n          help={userNameError || \"\"}\n        >\n          {getFieldDecorator(\"userName\", {\n            rules: [\n              {\n                required: true,\n                message:\n                  \"Please input the username of the person you want to chat with\"\n              }\n            ]\n          })(\n            <Select\n              mode=\"tags\"\n              style={{ width: \"100%\" }}\n              placeholder=\"Tags Mode\"\n              onChange={this.handleChange}\n            >\n              {[]}\n            </Select>\n          )}\n        </FormItem>\n        <FormItem>\n          <Button\n            type=\"primary\"\n            htmlType=\"submit\"\n            disabled={hasErrors(getFieldsError())}\n          >\n            Start a chat\n          </Button>\n        </FormItem>\n      </Form>\n    );\n  }\n}\n\nconst AddChatForm = Form.create()(HorizontalAddChatForm);\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token,\n    username: state.auth.username\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    closeAddChatPopup: () => dispatch(navActions.closeAddChatPopup()),\n    getUserChats: (username, token) =>\n      dispatch(messageActions.getUserChats(username, token))\n  };\n};\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(AddChatForm)\n);\n","import React from \"react\";\nimport { Modal } from \"antd\";\nimport Form from \"./Form\";\n\nclass AddChatModal extends React.Component {\n  render() {\n    return (\n      <Modal\n        centered\n        footer={null}\n        visible={this.props.isVisible}\n        onCancel={this.props.close}\n      >\n        <Form />\n      </Modal>\n    );\n  }\n}\n\nexport default AddChatModal;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport BaseRouter from \"./routes\";\nimport Sidepanel from \"./containers/Sidepanel\";\nimport Profile from \"./containers/Profile\";\nimport AddChatModal from \"./containers/Popup\";\nimport * as actions from \"./store/actions/auth\";\nimport * as navActions from \"./store/actions/nav\";\nimport * as messageActions from \"./store/actions/message\";\nimport WebSocketInstance from \"./websocket\";\nimport \"./assets/style.css\";\n\nclass App extends React.Component {\n  componentDidMount() {\n    this.props.onTryAutoSignup();\n  }\n\n  constructor(props) {\n    super(props);\n    WebSocketInstance.addCallbacks(\n      this.props.setMessages.bind(this),\n      this.props.addMessage.bind(this)\n    );\n  }\n\n  render() {\n    console.log(\"login\", this.props.authenticated);\n    console.log(\"login\", this.props.authenticated === null);\n    return (\n      <Router>\n        <div id=\"frame\">\n          if (this.props.authenticated !== null){<Sidepanel />}\n          <div className=\"content\">\n            <AddChatModal\n              isVisible={this.props.showAddChatPopup}\n              close={() => this.props.closeAddChatPopup()}\n            />\n            <Profile />\n            <BaseRouter />\n          </div>\n        </div>\n      </Router>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    showAddChatPopup: state.nav.showAddChatPopup,\n    authenticated: state.auth.token\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onTryAutoSignup: () => dispatch(actions.authCheckState()),\n    closeAddChatPopup: () => dispatch(navActions.closeAddChatPopup()),\n    addMessage: message => dispatch(messageActions.addMessage(message)),\n    setMessages: messages => dispatch(messageActions.setMessages(messages))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { createStore, compose, applyMiddleware, combineReducers } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport thunk from \"redux-thunk\";\nimport \"antd/dist/antd.css\";\nimport authReducer from \"./store/reducers/auth\";\nimport navReducer from \"./store/reducers/nav\";\nimport messageReducer from \"./store/reducers/message\";\nimport App from \"./App\";\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nfunction configureStore() {\n  const rootReducer = combineReducers({\n    auth: authReducer,\n    nav: navReducer,\n    message: messageReducer\n  });\n\n  const store = createStore(\n    rootReducer,\n    composeEnhancers(applyMiddleware(thunk))\n  );\n\n  //   if (module.hot) {\n  //     module.hot.accept(\"./store/reducers\", () => {\n  //       const nextRootReducer = require(\"./store/reducers/auth\");\n  //       store.replaceReducer(nextRootReducer);\n  //     });\n  //   }\n\n  return store;\n}\n\nconst store = configureStore();\n\nconst app = (\n  <Provider store={store}>\n    <App />\n  </Provider>\n);\n\nReactDOM.render(app, document.getElementById(\"app\"));\n"],"sourceRoot":""}